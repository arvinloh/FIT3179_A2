{
    "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
    "title": {
        "text": "Isotype Dot Plot of Maternal Age Distribution by State",
        "fontSize": 20,
        "font": "Roboto",
        "anchor": "start",
        "color": "black"
      },
      "config": { 
        "view": { 
          "stroke": null 
        } 
      },
    "width": 1300,
    "height": 400,  
    "background": null,
    "data": {
      "values": [
        { "Maternal_age": "Under 20", "State": "NSW", "Number": 1357 },
        { "Maternal_age": "Under 20", "State": "Vic", "Number": 684 },
        { "Maternal_age": "Under 20", "State": "Qld", "Number": 1482 },
        { "Maternal_age": "Under 20", "State": "WA", "Number": 595 },
        { "Maternal_age": "Under 20", "State": "SA", "Number": 286 },
        { "Maternal_age": "Under 20", "State": "Tas", "Number": 111 },
        { "Maternal_age": "Under 20", "State": "ACT", "Number": 53 },
        { "Maternal_age": "Under 20", "State": "NT", "Number": 201 },
        { "Maternal_age": "20â€“24", "State": "NSW", "Number": 8897 },
        { "Maternal_age": "20â€“24", "State": "Vic", "Number": 5380 },
        { "Maternal_age": "20â€“24", "State": "Qld", "Number": 8178 },
        { "Maternal_age": "20â€“24", "State": "WA", "Number": 3456 },
        { "Maternal_age": "20â€“24", "State": "SA", "Number": 1932 },
        { "Maternal_age": "20â€“24", "State": "Tas", "Number": 800 },
        { "Maternal_age": "20â€“24", "State": "ACT", "Number": 386 },
        { "Maternal_age": "20â€“24", "State": "NT", "Number": 590 },
        { "Maternal_age": "25â€“29", "State": "NSW", "Number": 24142 },
        { "Maternal_age": "25â€“29", "State": "Vic", "Number": 18583 },
        { "Maternal_age": "25â€“29", "State": "Qld", "Number": 17253 },
        { "Maternal_age": "25â€“29", "State": "WA", "Number": 8595 },
        { "Maternal_age": "25â€“29", "State": "SA", "Number": 5490 },
        { "Maternal_age": "25â€“29", "State": "Tas", "Number": 1762 },
        { "Maternal_age": "25â€“29", "State": "ACT", "Number": 1476 },
        { "Maternal_age": "25â€“29", "State": "NT", "Number": 999 },
        { "Maternal_age": "30â€“34", "State": "NSW", "Number": 36755 },
        { "Maternal_age": "30â€“34", "State": "Vic", "Number": 32578 },
        { "Maternal_age": "30â€“34", "State": "Qld", "Number": 21349 },
        { "Maternal_age": "30â€“34", "State": "WA", "Number": 12834 },
        { "Maternal_age": "30â€“34", "State": "SA", "Number": 7390 },
        { "Maternal_age": "30â€“34", "State": "Tas", "Number": 2097 },
        { "Maternal_age": "30â€“34", "State": "ACT", "Number": 2562 },
        { "Maternal_age": "30â€“34", "State": "NT", "Number": 1214 },
        { "Maternal_age": "35â€“39", "State": "NSW", "Number": 22080 },
        { "Maternal_age": "35â€“39", "State": "Vic", "Number": 19384 },
        { "Maternal_age": "35â€“39", "State": "Qld", "Number": 11757 },
        { "Maternal_age": "35â€“39", "State": "WA", "Number": 7284 },
        { "Maternal_age": "35â€“39", "State": "SA", "Number": 4001 },
        { "Maternal_age": "35â€“39", "State": "Tas", "Number": 1044 },
        { "Maternal_age": "35â€“39", "State": "ACT", "Number": 1563 },
        { "Maternal_age": "35â€“39", "State": "NT", "Number": 645 },
        { "Maternal_age": "40 and older", "State": "NSW", "Number": 4753 },
        { "Maternal_age": "40 and older", "State": "Vic", "Number": 4045 },
        { "Maternal_age": "40 and older", "State": "Qld", "Number": 2433 },
        { "Maternal_age": "40 and older", "State": "WA", "Number": 1437 },
        { "Maternal_age": "40 and older", "State": "SA", "Number": 810 },
        { "Maternal_age": "40 and older", "State": "Tas", "Number": 190 },
        { "Maternal_age": "40 and older", "State": "ACT", "Number": 312 },
        { "Maternal_age": "40 and older", "State": "NT", "Number": 133 }
      ]
    },
    "transform": [
        {
          "filter": "datum.State != 'Not stated' && datum.State != 'Australia'"
        },
        {
          "filter": { "selection": "StateSelector" }
        },
        {
          "calculate": "(datum.Number >= 2000) ? 2000 : (datum.Number >= 1000) ? 1000 : (datum.Number >= 100) ? 100 : (datum.Number >= 10) ? 10 : 1",
          "as": "scalingFactor"
        },
        {
          "calculate": "ceil(datum.Number / datum.scalingFactor)",
          "as": "symbolCount"
        },
        {
          "calculate": "sequence(1, datum.symbolCount, 1)",
          "as": "symbolArray"
        },
        {
          "flatten": ["symbolArray"]
        },
        {
          "calculate": "datum.symbolArray - 1",
          "as": "symbolIndex"
        },
        {
          "calculate": "datum.symbolIndex",
          "as": "col"
        },
        {
          "calculate": "(datum.scalingFactor == 2000) ? 'ðŸ¤°' : (datum.scalingFactor == 1000) ? 'ðŸ‘©' : (datum.scalingFactor == 100) ? 'ðŸ‘§' : 'ðŸ‘¶'",
          "as": "emoji"
        }
      ],
      "selection": {
        "StateSelector": {
          "type": "single",
          "fields": ["State"],
          "bind": {
            "input": "select",
            "options": ["NSW", "Vic", "Qld", "WA", "SA", "Tas", "ACT", "NT"],
            "name": "Select a State: "
          },
          "init": { "State": "NSW" }
        }
      },
      "mark": { 
        "type": "text", 
        "baseline": "middle", 
        "align": "center" 
      },
      "encoding": {
        "y": {
          "field": "Maternal_age",  
          "type": "ordinal",
          "axis": {
            "title": "Maternal Age",
            "labelFontSize": 12,
            "labelPadding": 5,
            "titleFontSize": 14
          },
          "sort": ["Under 20", "20â€“24", "25â€“29", "30â€“34", "35â€“39", "40 and older"]
        },
        "x": {
          "field": "col",     
          "type": "ordinal",
          "axis": null,
          "scale": { "padding": 1 }
        },
        "text": { "field": "emoji" },
        "size": { "value": 20 }, 
        "tooltip": [
          {
            "field": "Number",
            "type": "quantitative",
            "title": "Number of Mothers"
          },
          {
            "field": "scalingFactor",
            "type": "quantitative",
            "title": "Each Symbol Represents"
          },
          { "field": "Maternal_age", "type": "nominal", "title": "Maternal Age" },
          { "field": "State", "type": "nominal", "title": "State" }
        ],
        "color": {
          "field": "scalingFactor",
          "type": "nominal",
          "scale": {
            "domain": [2000, 1000, 100],
            "range": ["#FFC0CB", "#FF69B4", "#FF1493"]
          },
        "legend": {
          "title": "Symbol Represents",
          "symbolStrokeColor": null,
          "symbolSize": 0, 
          "labelExpr": "datum.label == 2000 ? 'ðŸ¤° = 2000 mothers' : datum.label == 1000 ? 'ðŸ‘© = 1000 mothers' : 'ðŸ‘§ = 100 mothers'",
          "labelFontSize": 14, 
          "titleFontSize": 16  
        }
    }
      },
      "autosize": {
        "type": "fit",
        "contains": "padding"
      }
    }
    